### Hi there ðŸ‘‹

**charli02/charli02** is a âœ¨ _special_ âœ¨ repository because its `README.md` (this file) appears on your GitHub profile.

Here are some ideas to get you started:

- ðŸ”­ Iâ€™m currently working on ...
- ðŸŒ± Iâ€™m currently learning ...
- ðŸ‘¯ Iâ€™m looking to collaborate on ...
- ðŸ¤” Iâ€™m looking for help with ...
- ðŸ’¬ Ask me about ...
- ðŸ“« How to reach me: ...
- ðŸ˜„ Pronouns: ...
- âš¡ Fun fact: ...
//Rotativa 
 public ActionResult CreateFileName()
        {
            string newFileName = Guid.NewGuid().ToString();
            return Json(new { data = newFileName });
        }
        
        -----------------------------------------------------
         function DownloadInvoice(InvoiceUID, BatchID) {
        ShowLoader();
        $.ajax({
            url: '@Url.Action("CreateFileName", "Operations")',
            type: 'POST',
            data: {},
            success: function (result) {
                $.ajax({
                    url: '@Url.Action("generateBillingInvoicePdf", "Billing")',
                    type: 'POST',
                    data: { FileName: result.data, BillingBatchUID: null, BillingBatchID: BatchID, InvoiceUID: InvoiceUID },
                    success: function (result1) {
                        HideLoader();
                        window.open("/Resources/Downloads/" + result.data + ".pdf", '_blank');
                    }
                });
            }
        });
    }
    
    ----------------------------------------------------------
    
    #region download invoice

        [ActionDownload]
        public ActionResult generateBillingInvoicePdf(string fileName, string BillingBatchUID, string BillingBatchID, string InvoiceUID, string DocSize, string InvoiceType)
        {
            try
            {
                #region Pdf

                string FileName = fileName + ".pdf";
                string path = Path.Combine(System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath + "/Resources/Downloads/");
                string savepath = path + FileName;

                DateTime currentDate = CommonFunction.fnDateTimeLocalWithUTC;
                string onlyDate = CommonFunction.ConvertDateToStringWithoutOffset(currentDate);//currentDate.ToString("MM/dd/yyyy").Replace("-", "/").Replace("-", "/");
                TimeSpan timeSpan = new TimeSpan(currentDate.TimeOfDay.Hours, currentDate.TimeOfDay.Minutes, 00);
                string onlyTime = new DateTime().Add(timeSpan).ToString("hh:mm tt");

                string userName = Session["LoginUserName"].ToString();

                string footer = "--footer-right \" Page: [page] of [toPage]\" " + "--footer-left \"Batch: " + BillingBatchID + "\" --footer-center \"Generated by " + userName + " on " + onlyDate + " at " + onlyTime + " \" --footer-font-size \"9\" --footer-spacing 5 --footer-font-name \"open sans\"";

                Rotativa.Core.DriverOptions footerItem = new Rotativa.Core.DriverOptions();
                footerItem.CustomSwitches = footer;
                if (DocSize != null)
                {
                    if (DocSize == "A4")
                    {
                        footerItem.PageSize = Rotativa.Core.Options.Size.A4;
                    }
                    else if (DocSize == "Letter")
                    {
                        footerItem.PageSize = Rotativa.Core.Options.Size.Letter;
                    }
                    else
                    {
                        footerItem.PageSize = Rotativa.Core.Options.Size.Letter;
                    }
                }
                else
                {
                    footerItem.PageSize = Rotativa.Core.Options.Size.Letter;
                }

                ActionAsPdf pdf = new ActionAsPdf("billingInvoiceTemplate1Pdf", new { BillingBatchUID = BillingBatchUID, CompanyID = CommonFunction.sCompanyID, DateFormatId = Convert.ToInt16("0" + Session["cDateFormatId"]), InvoiceUID = InvoiceUID, InvoiceType = InvoiceType })
                {
                    FileName = FileName,
#pragma warning disable CS0618 // 'AsPdfResultBase.SaveOnServerPath' is obsolete: 'Use BuildPdf(this.ControllerContext) method instead and use the resulting binary data to do what needed.'
                    SaveOnServerPath = savepath,
#pragma warning restore CS0618 // 'AsPdfResultBase.SaveOnServerPath' is obsolete: 'Use BuildPdf(this.ControllerContext) method instead and use the resulting binary data to do what needed.'
                    RotativaOptions = footerItem
                };
                return pdf;
                #endregion
            }
#pragma warning disable CS0168 // The variable 'ex' is declared but never used
            catch (Exception ex)
#pragma warning restore CS0168 // The variable 'ex' is declared but never used

            {
            }

            return Json(new { data = 1 });
        }

        public ActionResult billingInvoiceTemplate1Pdf(string BillingBatchUID, string CompanyID, int DateFormatId, string InvoiceUID, string InvoiceType)
        {
            if (InvoiceUID == null)
            {
                InvoiceUID = "";
            }
            if (BillingBatchUID == null)
            {
                BillingBatchUID = "";
            }
            var model = new InvoiceTemplateReportModel();
            model.DateFormatId = DateFormatId;
            model.BillingBatch_vw_Invocie_Template = _repository.GetBillingBatch_vw_Invocie_Template(BillingBatchUID, CompanyID, InvoiceUID, InvoiceType);
            model.BillingDetailByBillingBatchUIDList = _repository.GetBillingDetailByBillingBatchUID(BillingBatchUID, InvoiceUID, CompanyID);
            return View(model);
        }

        #endregion
    
